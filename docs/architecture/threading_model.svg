<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1977px" preserveAspectRatio="none" style="width:1458px;height:1977px;" version="1.1" viewBox="0 0 1458 1977" width="1458px" zoomAndPan="magnify"><defs><filter height="300%" id="fw7qhb9lgjjuy" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="100.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="418" y="260.2266"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="418" y="573.5547"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="418" y="1014.5469"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="418" y="1272.7422"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="418" y="1756.1328"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="211.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="289.3594"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="169.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="602.6875"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="871.0156"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="1043.6797"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="169.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="1301.875"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="1628.4688"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="1785.2656"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="98.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1002" y="772.4844"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="741.5859" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1232.5" y="1101.9453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="104" x2="104" y1="86.2969" y2="1890.6641"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="423" x2="423" y1="86.2969" y2="1890.6641"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="686" x2="686" y1="86.2969" y2="1890.6641"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1007" x2="1007" y1="86.2969" y2="1890.6641"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1237" x2="1237" y1="86.2969" y2="1890.6641"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1383" x2="1383" y1="86.2969" y2="1890.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="66" y="82.9951">Client app</text><ellipse cx="104" cy="13" fill="#FEFECE" filter="url(#fw7qhb9lgjjuy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M104,21 L104,48 M91,29 L117,29 M104,48 L91,63 M104,48 L117,63 " fill="none" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="66" y="1902.6592">Client app</text><ellipse cx="104" cy="1915.9609" fill="#FEFECE" filter="url(#fw7qhb9lgjjuy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M104,1923.9609 L104,1950.9609 M91,1931.9609 L117,1931.9609 M104,1950.9609 L91,1965.9609 M104,1950.9609 L117,1965.9609 " fill="none" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fw7qhb9lgjjuy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="368" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="375" y="70.9951">Client Thread</text><rect fill="#FEFECE" filter="url(#fw7qhb9lgjjuy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="368" y="1889.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="375" y="1909.6592">Client Thread</text><rect fill="#FEFECE" filter="url(#fw7qhb9lgjjuy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="616" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="623" y="70.9951">Command Thread</text><rect fill="#FEFECE" filter="url(#fw7qhb9lgjjuy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="616" y="1889.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="623" y="1909.6592">Command Thread</text><rect fill="#FEFECE" filter="url(#fw7qhb9lgjjuy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="937" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="944" y="70.9951">Expensive Thread</text><rect fill="#FEFECE" filter="url(#fw7qhb9lgjjuy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="937" y="1889.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="944" y="1909.6592">Expensive Thread</text><rect fill="#FEFECE" filter="url(#fw7qhb9lgjjuy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="1188" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="1195" y="70.9951">Pool Thread</text><rect fill="#FEFECE" filter="url(#fw7qhb9lgjjuy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="1188" y="1889.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="1195" y="1909.6592">Pool Thread</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="1326" y="82.9951">Pool with nodes</text><ellipse cx="1383.5" cy="13" fill="#0000FF" filter="url(#fw7qhb9lgjjuy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M1383.5,21 L1383.5,48 M1370.5,29 L1396.5,29 M1383.5,48 L1370.5,63 M1383.5,48 L1396.5,63 " fill="none" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="1326" y="1902.6592">Pool with nodes</text><ellipse cx="1383.5" cy="1915.9609" fill="#0000FF" filter="url(#fw7qhb9lgjjuy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M1383.5,1923.9609 L1383.5,1950.9609 M1370.5,1931.9609 L1396.5,1931.9609 M1383.5,1950.9609 L1370.5,1965.9609 M1383.5,1950.9609 L1396.5,1965.9609 " fill="none" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="100.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="418" y="260.2266"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="418" y="573.5547"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="418" y="1014.5469"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="418" y="1272.7422"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="418" y="1756.1328"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="211.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="289.3594"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="169.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="602.6875"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="871.0156"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="1043.6797"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="169.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="1301.875"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="1628.4688"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="681" y="1785.2656"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="98.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1002" y="772.4844"/><rect fill="#FFFFFF" filter="url(#fw7qhb9lgjjuy)" height="741.5859" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1232.5" y="1101.9453"/><path d="M320,101.2969 L320,156.2969 L521,156.2969 L521,111.2969 L511,101.2969 L320,101.2969 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M511,101.2969 L511,111.2969 L521,111.2969 L511,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="326" y="118.3638">Thread of an application,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="326" y="133.4966">used to transfer commands</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="326" y="148.6294">to Command thread.</text><path d="M571,101.2969 L571,156.2969 L797,156.2969 L797,111.2969 L787,101.2969 L571,101.2969 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M787,101.2969 L787,111.2969 L797,111.2969 L787,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="577" y="118.3638">Main thread of the library.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="577" y="133.4966">It executes biggest part of logic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="577" y="148.6294">that is implemented in Libindy</text><path d="M902,101.2969 L902,186.2969 L1108,186.2969 L1108,111.2969 L1098,101.2969 L902,101.2969 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1098,101.2969 L1098,111.2969 L1108,111.2969 L1098,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="908" y="118.3638">Thread that is occasionally</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="908" y="133.4966">used for execution of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="908" y="148.6294">some heavy operations like</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="908" y="163.7622">credential definition creation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="908" y="178.895">or key derivation</text><path d="M1122,101.2969 L1122,141.2969 L1349,141.2969 L1349,111.2969 L1339,101.2969 L1122,101.2969 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1339,101.2969 L1339,111.2969 L1349,111.2969 L1339,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="1128" y="118.3638">Thread used for communication</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="1128" y="133.4966">with nodes in pool</text><rect fill="#EEEEEE" filter="url(#fw7qhb9lgjjuy)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1443" x="3" y="216.5273"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1446" y1="216.5273" y2="216.5273"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1446" y1="219.5273" y2="219.5273"/><rect fill="#EEEEEE" filter="url(#fw7qhb9lgjjuy)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="201" x="624" y="205.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="630" y="222.0278">Common command cycle</text><polygon fill="#A80036" points="406,256.2266,416,260.2266,406,264.2266,410,260.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="412" y1="260.2266" y2="260.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="111" y="255.1606">indy_create_and_store_my_did</text><polygon fill="#A80036" points="669,285.3594,679,289.3594,669,293.3594,673,289.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="675" y1="289.3594" y2="289.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="435" y="284.2935">CreateAndStoreMyDid</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="691" x2="733" y1="318.4922" y2="318.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="733" x2="733" y1="318.4922" y2="331.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="692" x2="733" y1="331.4922" y2="331.4922"/><polygon fill="#A80036" points="702,327.4922,692,331.4922,702,335.4922,698,331.4922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="698" y="313.4263">do_logic</text><polygon fill="#A80036" points="115,356.625,105,360.625,115,364.625,111,360.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="422" y1="360.625" y2="360.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="121" y="355.5591">error code</text><path d="M15,373.625 L15,428.625 L188,428.625 L188,383.625 L178,373.625 L15,373.625 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M178,373.625 L178,383.625 L188,383.625 L178,373.625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="21" y="390.6919">App waits for result</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="21" y="405.8247">asynchronously if there</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="21" y="420.9575">was no error before</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="691" x2="733" y1="459.1563" y2="459.1563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="733" x2="733" y1="459.1563" y2="472.1563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="692" x2="733" y1="472.1563" y2="472.1563"/><polygon fill="#A80036" points="702,468.1563,692,472.1563,702,476.1563,698,472.1563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="698" y="454.0903">execute callback</text><polygon fill="#A80036" points="115,497.2891,105,501.2891,115,505.2891,111,501.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="685" y1="501.2891" y2="501.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="121" y="496.2231">result</text><rect fill="#EEEEEE" filter="url(#fw7qhb9lgjjuy)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1443" x="3" y="529.8555"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1446" y1="529.8555" y2="529.8555"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1446" y1="532.8555" y2="532.8555"/><rect fill="#EEEEEE" filter="url(#fw7qhb9lgjjuy)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="529" x="460" y="519.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="515" x="466" y="535.356">Expensive commands (key derivation, credential definition creation)</text><polygon fill="#A80036" points="406,569.5547,416,573.5547,406,577.5547,410,573.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="412" y1="573.5547" y2="573.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="295" x="111" y="568.4888">indy_issuer_create_and_store_credential_def</text><polygon fill="#A80036" points="669,598.6875,679,602.6875,669,606.6875,673,602.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="675" y1="602.6875" y2="602.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="435" y="597.6216">CreateAndStoreCredentialDefinition</text><polygon fill="#A80036" points="115,627.8203,105,631.8203,115,635.8203,111,631.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="422" y1="631.8203" y2="631.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="121" y="626.7544">error code</text><path d="M15,644.8203 L15,699.8203 L188,699.8203 L188,654.8203 L178,644.8203 L15,644.8203 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M178,644.8203 L178,654.8203 L188,654.8203 L178,644.8203 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="21" y="661.8872">App waits for result</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="21" y="677.02">asynchronously if there</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="21" y="692.1528">was no error before</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="691" x2="733" y1="730.3516" y2="730.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="733" x2="733" y1="730.3516" y2="743.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="692" x2="733" y1="743.3516" y2="743.3516"/><polygon fill="#A80036" points="702,739.3516,692,743.3516,702,747.3516,698,743.3516" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="698" y="725.2856">CreateCredentialDefinition</text><polygon fill="#A80036" points="990,768.4844,1000,772.4844,990,776.4844,994,772.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="686" x2="996" y1="772.4844" y2="772.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="693" y="767.4185">new_credential_definition</text><path d="M573,785.4844 L573,840.4844 L794,840.4844 L794,795.4844 L784,785.4844 L573,785.4844 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M784,785.4844 L784,795.4844 L794,795.4844 L784,785.4844 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="579" y="802.5513">Command thread can execute</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="579" y="817.6841">other commands during</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="579" y="832.8169">the work of expensive thread</text><polygon fill="#A80036" points="702,867.0156,692,871.0156,702,875.0156,698,871.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="696" x2="1006" y1="871.0156" y2="871.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="708" y="865.9497">CreateAndStoreCredentialDefinitionContinue</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="691" x2="733" y1="900.1484" y2="900.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="733" x2="733" y1="900.1484" y2="913.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="692" x2="733" y1="913.1484" y2="913.1484"/><polygon fill="#A80036" points="702,909.1484,692,913.1484,702,917.1484,698,913.1484" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="698" y="895.0825">execute callback</text><polygon fill="#A80036" points="115,938.2813,105,942.2813,115,946.2813,111,942.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="685" y1="942.2813" y2="942.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="121" y="937.2153">result</text><rect fill="#EEEEEE" filter="url(#fw7qhb9lgjjuy)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1443" x="3" y="970.8477"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1446" y1="970.8477" y2="970.8477"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1446" y1="973.8477" y2="973.8477"/><rect fill="#EEEEEE" filter="url(#fw7qhb9lgjjuy)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="255" x="597" y="960.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="241" x="603" y="976.3481">Pool communication commands</text><polygon fill="#A80036" points="406,1010.5469,416,1014.5469,406,1018.5469,410,1014.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="412" y1="1014.5469" y2="1014.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="111" y="1009.481">indy_open_pool</text><polygon fill="#A80036" points="669,1039.6797,679,1043.6797,669,1047.6797,673,1043.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="675" y1="1043.6797" y2="1043.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="435" y="1038.6138">Open</text><polygon fill="#A80036" points="115,1068.8125,105,1072.8125,115,1076.8125,111,1072.8125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="422" y1="1072.8125" y2="1072.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="121" y="1067.7466">error code</text><polygon fill="#A80036" points="1220.5,1097.9453,1230.5,1101.9453,1220.5,1105.9453,1224.5,1101.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="691" x2="1226.5" y1="1101.9453" y2="1101.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="698" y="1096.8794">Pool::new</text><polygon fill="#A80036" points="1371.5,1127.0781,1381.5,1131.0781,1371.5,1135.0781,1375.5,1131.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1242.5" x2="1377.5" y1="1131.0781" y2="1131.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="1249.5" y="1126.0122">sync network</text><polygon fill="#A80036" points="1253.5,1156.2109,1243.5,1160.2109,1253.5,1164.2109,1249.5,1160.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1247.5" x2="1382.5" y1="1160.2109" y2="1160.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="1259.5" y="1155.145">fresh network info</text><polygon fill="#A80036" points="115,1185.3438,105,1189.3438,115,1193.3438,111,1189.3438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="685" y1="1189.3438" y2="1189.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="121" y="1184.2778">pool_handle</text><path d="M8,1202.3438 L8,1242.3438 L196,1242.3438 L196,1212.3438 L186,1202.3438 L8,1202.3438 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M186,1202.3438 L186,1212.3438 L196,1212.3438 L186,1202.3438 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="14" y="1219.4106">From now on pool works</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="14" y="1234.5435">and requests can be sent</text><polygon fill="#A80036" points="406,1268.7422,416,1272.7422,406,1276.7422,410,1272.7422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="412" y1="1272.7422" y2="1272.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="111" y="1267.6763">indy_submit_request</text><polygon fill="#A80036" points="669,1297.875,679,1301.875,669,1305.875,673,1301.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="675" y1="1301.875" y2="1301.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="435" y="1296.8091">SubmitRequest</text><polygon fill="#A80036" points="115,1327.0078,105,1331.0078,115,1335.0078,111,1331.0078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="422" y1="1331.0078" y2="1331.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="121" y="1325.9419">error code</text><path d="M15,1344.0078 L15,1399.0078 L188,1399.0078 L188,1354.0078 L178,1344.0078 L15,1344.0078 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M178,1344.0078 L178,1354.0078 L188,1354.0078 L178,1344.0078 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="21" y="1361.0747">App waits for result</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="21" y="1376.2075">asynchronously if there</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="21" y="1391.3403">was no error before</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="691" x2="733" y1="1429.5391" y2="1429.5391"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="733" x2="733" y1="1429.5391" y2="1442.5391"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="692" x2="733" y1="1442.5391" y2="1442.5391"/><polygon fill="#A80036" points="702,1438.5391,692,1442.5391,702,1446.5391,698,1442.5391" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="698" y="1424.4731">send_tx</text><polygon fill="#A80036" points="1220.5,1467.6719,1230.5,1471.6719,1220.5,1475.6719,1224.5,1471.6719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="686" x2="1226.5" y1="1471.6719" y2="1471.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="693" y="1466.606">_send_message</text><path d="M573,1484.6719 L573,1539.6719 L794,1539.6719 L794,1494.6719 L784,1484.6719 L573,1484.6719 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M784,1484.6719 L784,1494.6719 L794,1494.6719 L784,1484.6719 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="579" y="1501.7388">Command thread can execute</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="579" y="1516.8716">other commands during</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="579" y="1532.0044">the work of pool thread</text><polygon fill="#A80036" points="1371.5,1566.2031,1381.5,1570.2031,1371.5,1574.2031,1375.5,1570.2031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1242.5" x2="1377.5" y1="1570.2031" y2="1570.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="1249.5" y="1565.1372">send(json)</text><polygon fill="#A80036" points="1253.5,1595.3359,1243.5,1599.3359,1253.5,1603.3359,1249.5,1599.3359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1247.5" x2="1382.5" y1="1599.3359" y2="1599.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="1259.5" y="1594.27">responses</text><polygon fill="#A80036" points="702,1624.4688,692,1628.4688,702,1632.4688,698,1628.4688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="696" x2="1231.5" y1="1628.4688" y2="1628.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="708" y="1623.4028">aggregated response</text><polygon fill="#A80036" points="115,1653.6016,105,1657.6016,115,1661.6016,111,1657.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="685" y1="1657.6016" y2="1657.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="121" y="1652.5356">result</text><path d="M9,1670.6016 L9,1725.6016 L195,1725.6016 L195,1680.6016 L185,1670.6016 L9,1670.6016 " fill="#FBFB77" filter="url(#fw7qhb9lgjjuy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M185,1670.6016 L185,1680.6016 L195,1680.6016 L185,1670.6016 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="15" y="1687.6685">When the work is over,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="15" y="1702.8013">you should close the pool</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="15" y="1717.9341">and it will kill the thread</text><polygon fill="#A80036" points="406,1752.1328,416,1756.1328,406,1760.1328,410,1756.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="412" y1="1756.1328" y2="1756.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="111" y="1751.0669">indy_close_pool</text><polygon fill="#A80036" points="669,1781.2656,679,1785.2656,669,1789.2656,673,1785.2656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="675" y1="1785.2656" y2="1785.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="435" y="1780.1997">Close</text><polygon fill="#A80036" points="115,1810.3984,105,1814.3984,115,1818.3984,111,1814.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="109" x2="422" y1="1814.3984" y2="1814.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="121" y="1809.3325">error code</text><polygon fill="#A80036" points="1225.5,1839.5313,1235.5,1843.5313,1225.5,1847.5313,1229.5,1843.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="691" x2="1231.5" y1="1843.5313" y2="1843.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="698" y="1838.4653">Pool::close</text><polygon fill="#A80036" points="115,1868.6641,105,1872.6641,115,1876.6641,111,1872.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="685" y1="1872.6641" y2="1872.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="121" y="1867.5981">error code</text><!--
@startuml
actor "Client app" as App
participant "Client Thread" as Client
note over Client
    Thread of an application,
    used to transfer commands
    to Command thread.
end note
participant "Command Thread" as Command
/ note over Command
    Main thread of the library.
    It executes biggest part of logic
    that is implemented in Libindy
end note
participant "Expensive Thread" as Expensive
/ note over Expensive
    Thread that is occasionally
    used for execution of
    some heavy operations like
    credential definition creation
    or key derivation
end note
participant "Pool Thread" as Pool
/ note over Pool
    Thread used for communication
    with nodes in pool
end note
actor "Pool with nodes" as Nodes #blue

==Common command cycle==
App -> Client: indy_create_and_store_my_did
activate Client
Client -> Command: CreateAndStoreMyDid
activate Command
Command -> Command: do_logic
Client - -> App: error code
note over App
    App waits for result
    asynchronously if there
    was no error before
end note
deactivate Client
Command -> Command: execute callback
Command - -> App: result
deactivate Command

==Expensive commands (key derivation, credential definition creation)==
App -> Client: indy_issuer_create_and_store_credential_def
activate Client
Client -> Command: CreateAndStoreCredentialDefinition
activate Command
Client - -> App: error code
deactivate Client
note over App
    App waits for result
    asynchronously if there
    was no error before
end note
Command -> Command: CreateCredentialDefinition
Command -> Expensive: new_credential_definition
deactivate Command
note over Command
    Command thread can execute
    other commands during
    the work of expensive thread
end note
activate Expensive
Expensive -> Command: CreateAndStoreCredentialDefinitionContinue
deactivate Expensive
activate Command
Command -> Command: execute callback
Command - -> App: result
deactivate Command

==Pool communication commands==
App -> Client: indy_open_pool
activate Client
Client -> Command: Open
activate Command
Client - -> App: error code
deactivate Client
Command -> Pool: Pool::new
activate Pool
Pool -> Nodes: sync network
Nodes - -> Pool: fresh network info
Command - -> App: pool_handle
deactivate Command

note over App
    From now on pool works
    and requests can be sent
end note

App -> Client: indy_submit_request
activate Client
Client -> Command: SubmitRequest
activate Command
Client - -> App: error code
deactivate Client

note over App
    App waits for result
    asynchronously if there
    was no error before
end note
Command -> Command: send_tx
Command -> Pool: _send_message
note over Command
    Command thread can execute
    other commands during
    the work of pool thread
end note
deactivate Command
Pool -> Nodes: send(json)
Nodes -> Pool: responses
Pool - -> Command: aggregated response
activate Command
Command - -> App: result
deactivate Command

note over App
    When the work is over,
    you should close the pool
    and it will kill the thread
end note

App -> Client: indy_close_pool
activate Client
Client -> Command: Close
activate Command
Client -> App: error code
deactivate Client
Command -> Pool: Pool::close
deactivate Pool
Command - -> App: error code
deactivate Command
@enduml

PlantUML version 1.2019.08(Sat Jul 13 22:25:14 MSK 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b26
Operating System: Linux
OS Version: 5.0.4-arch1-1-ARCH
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>